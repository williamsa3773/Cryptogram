
var helpers      = require("../util/helpers")
var surgeSDK     = require("surge-sdk")

module.exports = function(req, next){

  var sdk = surgeSDK({
    endpoint: req.endpoint.format(),
    defaults: helpers.defaults
  })

  var domain  = req.argv["_"][0]
  var rev     = req.argv["_"][1] || null

  //helpers.trunc("coming soon".grey)

  // var data = {"normalizedAt":"2021-03-20T08:22:26.170Z","version":"0.6.4","domain":"surge.sh","range":["2021-03-07","2021-03-08","2021-03-09","2021-03-10","2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16","2021-03-17","2021-03-18","2021-03-19","2021-03-20"],"general":{"visits":{"total":12980,"breakdown":[0,0,0,0,0,0,0,0,0,0,3877,4295,3985,823]},"connections":{"total":126404,"breakdown":[0,0,0,0,0,0,0,0,0,0,36174,41684,41486,7060]},"bandwidth":{"total":3404488989,"breakdown":[0,0,0,0,0,0,0,0,0,0,988898062,1139372814,1100231406,175986707]}},"status":[{"code":"200","total":84259,"breakdown":[0,0,0,0,0,0,0,0,0,0,24288,28423,27261,4287]},{"code":"304","total":28197,"breakdown":[0,0,0,0,0,0,0,0,0,0,7981,8835,9747,1634]},{"code":"404","total":9005,"breakdown":[0,0,0,0,0,0,0,0,0,0,2627,2743,2909,726]},{"code":"301","total":4638,"breakdown":[0,0,0,0,0,0,0,0,0,0,1163,1577,1498,400]},{"code":"206","total":305,"breakdown":[0,0,0,0,0,0,0,0,0,0,115,106,71,13]}],"encryption":[{"type":"Unencrypted","total":64820,"breakdown":[0,0,0,0,0,0,0,0,0,0,35115,29705,0,0]},{"type":"Encrypted","total":57332,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,10523,40119,6690]},{"type":"Forced HTTPS","total":4252,"breakdown":[0,0,0,0,0,0,0,0,0,0,1059,1456,1367,370]},{"type":"Forced HTTP","total":0,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,0]}],"source":[{"name":"https://surge.sh/","total":80981,"breakdown":[0,0,0,0,0,0,0,0,0,0,22900,27220,26925,3936]},{"name":"https://surge.sh/help/getting-started-with-surge","total":6929,"breakdown":[0,0,0,0,0,0,0,0,0,0,2218,2221,2179,311]},{"name":"https://surge.sh/pricing","total":2907,"breakdown":[0,0,0,0,0,0,0,0,0,0,834,932,891,250]},{"name":"https://surge.sh/help/adding-a-custom-domain","total":2387,"breakdown":[0,0,0,0,0,0,0,0,0,0,634,797,816,140]},{"name":"https://surge.sh/help/","total":1577,"breakdown":[0,0,0,0,0,0,0,0,0,0,467,485,528,97]},{"name":"https://www.google.com/","total":1534,"breakdown":[0,0,0,0,0,0,0,0,0,0,459,512,475,88]},{"name":"https://surge.sh/tour","total":1376,"breakdown":[0,0,0,0,0,0,0,0,0,0,399,407,462,108]},{"name":"https://surge.sh/help/securing-your-custom-domain-with-ssl","total":755,"breakdown":[0,0,0,0,0,0,0,0,0,0,101,294,292,68]},{"name":"https://tmm-slope.surge.sh/","total":729,"breakdown":[0,0,0,0,0,0,0,0,0,0,227,263,239,0]},{"name":"https://surge.sh/help/remembering-a-domain","total":574,"breakdown":[0,0,0,0,0,0,0,0,0,0,149,187,218,20]},{"name":"https://surge.sh/help/tearing-down-a-project","total":397,"breakdown":[0,0,0,0,0,0,0,0,0,0,105,109,183,0]},{"name":"https://surge.surge.sh/","total":383,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,117,248,18]},{"name":"https://tam-run3.surge.sh/","total":368,"breakdown":[0,0,0,0,0,0,0,0,0,0,115,124,129,0]},{"name":"https://surge.sh/help/using-https-by-default","total":350,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,154,151,45]},{"name":"http://surge.sh/","total":259,"breakdown":[0,0,0,0,0,0,0,0,0,0,160,99,0,0]},{"name":"https://surge.sh/help/adding-a-200-page-for-client-side-routing","total":135,"breakdown":[0,0,0,0,0,0,0,0,0,0,135,0,0,0]},{"name":"https://surge.sh/help/resetting-your-password","total":132,"breakdown":[0,0,0,0,0,0,0,0,0,0,132,0,0,0]},{"name":"https://surge.sh/help/copying-extra-files-into-the-directory-you-publish","total":122,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,122,0,0]},{"name":"http://www.surge.sh/","total":121,"breakdown":[0,0,0,0,0,0,0,0,0,0,121,0,0,0]},{"name":"https://surge.sh/help/using-incremental-publishing","total":104,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,104,0]},{"name":"https://surge.sh/help/listing-all-your-projects","total":97,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,97,0]},{"name":"https://surge.sh/help/upgrading-to-surge-plus","total":42,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,42]},{"name":"https://surge.sh/plus/","total":27,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,27]},{"name":"https://surge.sh/help/deploying-continuously-using-git-hooks","total":20,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,20]},{"name":"https://surge.sh/terms","total":14,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,14]},{"name":"https://surge.sh/help/chat","total":14,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,14]}],"device":[],"os":[],"browser":[],"success":[{"path":"/","total":8386,"breakdown":[0,0,0,0,0,0,0,0,0,0,2553,2807,2514,512]},{"path":"/help/getting-started-with-surge","total":1096,"breakdown":[0,0,0,0,0,0,0,0,0,0,381,343,315,57]},{"path":"/pricing","total":780,"breakdown":[0,0,0,0,0,0,0,0,0,0,224,263,230,63]},{"path":"/help/","total":414,"breakdown":[0,0,0,0,0,0,0,0,0,0,117,126,140,31]},{"path":"/help/adding-a-custom-domain","total":371,"breakdown":[0,0,0,0,0,0,0,0,0,0,98,127,123,23]},{"path":"/tour","total":223,"breakdown":[0,0,0,0,0,0,0,0,0,0,60,65,77,21]},{"path":"/help/remembering-a-domain","total":117,"breakdown":[0,0,0,0,0,0,0,0,0,0,34,36,47,0]},{"path":"/help/using-https-by-default","total":107,"breakdown":[0,0,0,0,0,0,0,0,0,0,26,36,32,13]},{"path":"/help/tearing-down-a-project","total":96,"breakdown":[0,0,0,0,0,0,0,0,0,0,23,33,40,0]},{"path":"/help/adding-a-200-page-for-client-side-routing","total":90,"breakdown":[0,0,0,0,0,0,0,0,0,0,23,27,33,7]},{"path":"/help/copying-extra-files-into-the-directory-you-publish","total":74,"breakdown":[0,0,0,0,0,0,0,0,0,0,18,32,24,0]},{"path":"/help/securing-your-custom-domain-with-ssl","total":72,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,30,35,7]},{"path":"/help/adding-a-custom-404-not-found-page","total":66,"breakdown":[0,0,0,0,0,0,0,0,0,0,17,21,22,6]},{"path":"/help/upgrading-to-surge-plus","total":42,"breakdown":[0,0,0,0,0,0,0,0,0,0,17,0,20,5]},{"path":"/help/enabling-cross-origin-resource-sharing","total":33,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,27,0,6]},{"path":"/terms","total":29,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,22,0,7]},{"path":"/help/deploying-continuously-using-git-hooks","total":28,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,21,7]},{"path":"/plus/","total":20,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,20,0]},{"path":"/help/listing-all-your-projects","total":20,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,20,0,0]},{"path":"/help/resetting-your-password","total":19,"breakdown":[0,0,0,0,0,0,0,0,0,0,19,0,0,0]},{"path":"/help/chat","total":19,"breakdown":[0,0,0,0,0,0,0,0,0,0,19,0,0,0]},{"path":"/help/why-is-surge-free","total":15,"breakdown":[0,0,0,0,0,0,0,0,0,0,15,0,0,0]},{"path":"/privacy","total":7,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,7]},{"path":"/help/deploying-a-jekyll-project","total":6,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,6]}],"fail":[{"path":"/favicon.ico","total":4984,"breakdown":[0,0,0,0,0,0,0,0,0,0,1554,1590,1494,346]},{"path":"/robots.txt","total":848,"breakdown":[0,0,0,0,0,0,0,0,0,0,199,199,352,98]},{"path":"/app-ads.txt","total":837,"breakdown":[0,0,0,0,0,0,0,0,0,0,223,197,328,89]},{"path":"/apple-touch-icon.png","total":230,"breakdown":[0,0,0,0,0,0,0,0,0,0,89,56,69,16]},{"path":"/apple-touch-icon-precomposed.png","total":230,"breakdown":[0,0,0,0,0,0,0,0,0,0,89,55,70,16]},{"path":"/ads.txt","total":158,"breakdown":[0,0,0,0,0,0,0,0,0,0,42,48,51,17]},{"path":"/.well-known/assetlinks.json","total":131,"breakdown":[0,0,0,0,0,0,0,0,0,0,27,31,52,21]},{"path":"/laybuy.surge.sh/styles.css","total":84,"breakdown":[0,0,0,0,0,0,0,0,0,0,26,31,22,5]},{"path":"/laybuy.surge.sh/cursor.svg","total":74,"breakdown":[0,0,0,0,0,0,0,0,0,0,22,33,19,0]},{"path":"/bluelaba.surge.sh/static/media/logo-no-bg.3de290ee.svg","total":70,"breakdown":[0,0,0,0,0,0,0,0,0,0,25,25,20,0]},{"path":"/apple-touch-icon-120x120-precomposed.png","total":67,"breakdown":[0,0,0,0,0,0,0,0,0,0,25,19,23,0]},{"path":"/apple-touch-icon-120x120.png","total":66,"breakdown":[0,0,0,0,0,0,0,0,0,0,25,19,22,0]},{"path":"/laybuy.surge.sh/calendar.svg","total":65,"breakdown":[0,0,0,0,0,0,0,0,0,0,16,29,15,5]},{"path":"/laybuy.surge.sh/laybuy-badge.svg","total":50,"breakdown":[0,0,0,0,0,0,0,0,0,0,17,27,0,6]},{"path":"/sellers.json","total":33,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,29,4]},{"path":"/laybuy.surge.sh/smiling-face.svg","total":30,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,25,0,5]},{"path":"/.well-known/pki-validation/ca3-eea3ad4bfff14d1fb386f6fd02f5693a.txt","total":30,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,23,7]},{"path":"/.well-known/pki-validation/ca3-dfd32aaf9fed492b83ca9e55634ed5c9.txt","total":30,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,23,7]},{"path":"/apple-touch-icon-152x152-precomposed.png","total":25,"breakdown":[0,0,0,0,0,0,0,0,0,0,18,0,0,7]},{"path":"/apple-touch-icon-152x152.png","total":24,"breakdown":[0,0,0,0,0,0,0,0,0,0,18,0,0,6]},{"path":"/csshake.surge.sh/csshake.min.css","total":21,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,21,0,0]}],"redirect":[{"path":"/css/index.css","total":2778,"breakdown":[0,0,0,0,0,0,0,0,0,0,1381,1397,0,0]},{"path":"/images/logos/svg/surge-logo.svg","total":2730,"breakdown":[0,0,0,0,0,0,0,0,0,0,1372,1358,0,0]},{"path":"/js/cache.js","total":2713,"breakdown":[0,0,0,0,0,0,0,0,0,0,1361,1352,0,0]},{"path":"/","total":1877,"breakdown":[0,0,0,0,0,0,0,0,0,0,899,978,0,0]},{"path":"/images/tour/tour-landing-example.png","total":717,"breakdown":[0,0,0,0,0,0,0,0,0,0,358,359,0,0]},{"path":"/images/surge-companion-github.png","total":619,"breakdown":[0,0,0,0,0,0,0,0,0,0,298,321,0,0]},{"path":"/images/surge-companion-cli.png","total":592,"breakdown":[0,0,0,0,0,0,0,0,0,0,286,306,0,0]},{"path":"/images/surge-companion-grunt.png","total":591,"breakdown":[0,0,0,0,0,0,0,0,0,0,286,305,0,0]},{"path":"/images/surge-companion-gulp.png","total":586,"breakdown":[0,0,0,0,0,0,0,0,0,0,283,303,0,0]},{"path":"/images/surge-companion-npm.png","total":585,"breakdown":[0,0,0,0,0,0,0,0,0,0,287,298,0,0]},{"path":"/images/surge-companion-jekyll.png","total":568,"breakdown":[0,0,0,0,0,0,0,0,0,0,277,291,0,0]},{"path":"/images/surge-companion-node.png","total":568,"breakdown":[0,0,0,0,0,0,0,0,0,0,278,290,0,0]},{"path":"/images/surge-companion-travis-ci.png","total":534,"breakdown":[0,0,0,0,0,0,0,0,0,0,258,276,0,0]},{"path":"/images/help/adding-collaborators.gif","total":420,"breakdown":[0,0,0,0,0,0,0,0,0,0,211,209,0,0]},{"path":"/help/getting-started-with-surge","total":230,"breakdown":[0,0,0,0,0,0,0,0,0,0,127,103,0,0]},{"path":"301 /help","total":147,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,120,27]},{"path":"/images/help/getting-started-with-surge.gif","total":113,"breakdown":[0,0,0,0,0,0,0,0,0,0,113,0,0,0]},{"path":"/help","total":108,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,108,0,0]},{"path":"301 /plus","total":13,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,11,2]},{"path":"301 /stickers","total":1,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,1]}],"load":[{"path":"/js/cache.js","total":662398048,"breakdown":[0,0,0,0,0,0,0,0,0,0,189209522,223910746,216992464,32285316]},{"path":"/images/help/getting-started-with-surge.gif","total":599524223,"breakdown":[0,0,0,0,0,0,0,0,0,0,188847740,191922892,183551909,35201682]},{"path":"/images/tour/tour-landing-example.png","total":586248863,"breakdown":[0,0,0,0,0,0,0,0,0,0,168404313,199439873,190615584,27789093]},{"path":"/images/surge-companion-travis-ci.png","total":403651187,"breakdown":[0,0,0,0,0,0,0,0,0,0,116137028,136635927,131783528,19094704]},{"path":"/css/index.css","total":371018664,"breakdown":[0,0,0,0,0,0,0,0,0,0,104976072,125459208,122422464,18160920]},{"path":"/index.html","total":162912309,"breakdown":[0,0,0,0,0,0,0,0,0,0,49570458,54556110,50019984,8765757]},{"path":"/images/help/adding-collaborators.gif","total":101566811,"breakdown":[0,0,0,0,0,0,0,0,0,0,31066942,32639837,32344299,5515733]},{"path":"/images/surge-companion-grunt.png","total":69371565,"breakdown":[0,0,0,0,0,0,0,0,0,0,19933916,23495374,22688281,3253994]},{"path":"/images/logos/svg/surge-logo.svg","total":40754960,"breakdown":[0,0,0,0,0,0,0,0,0,0,11548336,13984416,13194336,2027872]},{"path":"/404.html","total":36478615,"breakdown":[0,0,0,0,0,0,0,0,0,0,9686580,11339085,12433520,3019430]},{"path":"/images/surge-companion-jekyll.png","total":36123912,"breakdown":[0,0,0,0,0,0,0,0,0,0,10414404,12272436,11760804,1676268]},{"path":"/images/surge-companion-github.png","total":33848328,"breakdown":[0,0,0,0,0,0,0,0,0,0,9771876,11453664,11009772,1613016]},{"path":"/images/surge-companion-gulp.png","total":30697624,"breakdown":[0,0,0,0,0,0,0,0,0,0,8847400,10371436,10028956,1449832]},{"path":"/images/plus/plus-ssl-example.png","total":30392262,"breakdown":[0,0,0,0,0,0,0,0,0,0,8197404,10440090,10053420,1701348]},{"path":"/images/surge-companion-cli.png","total":22565600,"breakdown":[0,0,0,0,0,0,0,0,0,0,6512870,7641150,7342240,1069340]},{"path":"/images/surge-companion-node.png","total":10891968,"breakdown":[0,0,0,0,0,0,0,0,0,0,4990656,5901312,0,0]},{"path":"/images/help/adding-a-custom-domain-2.png","total":5701400,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,5701400,0]},{"path":"/images/help/adding-a-custom-domain.png","total":941137,"breakdown":[0,0,0,0,0,0,0,0,0,0,0,0,0,941137]}]}
  // helpers.displayAnalytics(data)
  // return next()
  
  //helpers.space()
  sdk.analytics(domain, { user: "token", pass: req.creds.token }, function(error, response){
    helpers.displayAnalytics(response)
    return next()
  })
  
}